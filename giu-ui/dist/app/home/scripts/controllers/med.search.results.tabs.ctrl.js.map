{"version":3,"sources":["app/home/scripts/controllers/med.search.results.tabs.ctrl.js"],"names":[],"mappings":"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","file":"app/home/scripts/controllers/med.search.results.tabs.ctrl.js","sourcesContent":["'use strict';\n\nimport Selectable from 'module-crud-ui/app/scripts/crud.selectable.js';\n\nexport default class SearchResultsTabsCtrl extends Selectable {\n\n  /*@ngInject*/\n  constructor(api, $state, alertService, $filter) {\n\n    super({itemKey: 'id', enabled: true});\n    this.api = api;\n    this.state = $state;\n    this.alertService = alertService;\n\n    this.translate = $filter.translate;\n    this.segments = this.getDetailData('mediaSegments');\n    this.hotStart = this.getDetailData('mediaHotStart');\n    this.ratings = this.getDetailData('mediaRatings');\n    this.rejections = this.getDetailData('mediaRejections');\n    this.rejectionSelComment = false;\n\n\tthis.relMedias = {\n\t  origin: 'FIB1-TX-1092364',\n      root: 'FIB1-TX-1092365'\n    };\n\n    this.sot = {\n      totalNumber: 3,\n      partNumber: 2,\n      setOfTapes: [285,286,287]\n    };\n\n  }\n\n  getPathParams(){\n    return { 'detailCid': this.state.params.id };\n  }\n\n  saveEtc(form) {\n    if (form.$valid) {\n      let promise;\n      this.isLoading = true;\n      promise = this.api.etc.save(this.params, this.entity).$promise;\n\n      promise.then((response) => {\n        this.isLoading = false;\n\n        this.alertService.success(\n          {\n            title: this.translate(\"results.tabs.rejections.submit.success.title\"),\n            message: this.translate(\"results.tabs.rejections.submit.success.message\")\n          }\n        );\n      }, (err) => {\n        this.alertService.error({\n          title: this.translate(\"results.tabs.rejections.submit.error\"),\n          message: err.data.message\n\n        });\n      });\n      return promise;\n    } else {\n      this.$log.info('form invalid');\n      return undefined;\n    }\n  }\n\n    getDetailData(endpoint){\n        this.response = this.api[endpoint].get(this.getPathParams());\n        this.response.isLoading = true;\n        var objectData = this.response;\n\n        this.response.$promise.then(() => {\n\n          objectData.isLoading = false;\n          objectData.valid = true;\n\n        }, function(error) {\n          // Si nos devuelve un 404, no queremos que se muestre el recurso, pero tampoco que nos tire error\n          if(error.status == 404){\n            objectData.valid = false;\n            objectData.isLoading = false;\n          }\n        });\n        return this.response;\n    }\n\n    allTabsHasBeenLoaded(){\n      return this.segments && !this.segments.isLoading && this.hotStart && !this.hotStart.isLoading &&\n        this.ratings && !this.ratings.isLoading && this.rejections && !this.rejections.isLoading;\n    }\n\n    isParamValid(param){\n      return param !== undefined && param !== null;\n    }\n  setSelectableForRejections() {\n    this.collection = this.rejections.content;\n  }\n\n\n    selectRejection(){\n        return { 'detailCid': this.state.params.id };\n    }\n\n    onSegmentsEdit(){\n      this.state.go('segmentsEdit', { 'detailCid': this.state.params.id });\n    }\n\n  rowClick(row) {\n    row.selected = !row.selected;\n    this.change(row);\n  }\n    isSegmentIngested(lowResStatusActive){\n      var items = this.segments.items;\n      if(items && items.length > 0) {\n        var lastSegment = items[items.length - 1];\n        var lowResStatus = lastSegment.lowResStatus == 'Y';\n        return lastSegment.isIngested && ((lowResStatusActive && lowResStatus) || (!lowResStatusActive && !lowResStatus));\n      }\n      return false;\n    }\n\n  checkRejectionClick($event, row) {\n    row.selected = !row.selected;\n    $event.preventDefault();\n  }\n    isHotstartEnabledRed(){\n      return this.isSegmentIngested(false);\n    }\n\n    isHotstartEnabledGreen(){\n      return this.isSegmentIngested(true);\n    }\n\n    isHotstartEnabledOriginalColor(){\n      return !this.isHotstartEnabledRed() && !this.isHotstartEnabledGreen();\n    }\n\n}\n\n"],"sourceRoot":"/source/"}